<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 한국 로보컵 오픈 - K.F.C. Codechaser</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Noto+Sans+KR:wght@300;400;700&display=swap');

        :root {
            --primary: #00f2fe;
            --secondary: #4facfe;
            --accent: #ff0000;
            --bg-dark: #0f172a;
            --text-light: #f8fafc;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-dark);
            color: var(--text-light);
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
            overflow-x: hidden;
        }

        /* Gauge Progress Bar */
        #progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #page-title {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--primary);
            margin-bottom: 5px;
        }

        #gauge-bar-bg {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        #gauge-bar-fill {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.4s ease;
        }

        /* Audio Control */
        #audio-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.07);
            padding: 10px 20px;
            border-radius: 20px;
            border: 1px solid rgba(0, 242, 254, 0.3);
            backdrop-filter: blur(15px);
            box-shadow: 0 0 15px rgba(0, 242, 254, 0.2);
        }

        /* Sections */
        section {
            position: relative;
            min-height: 100vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 120px 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
        }

        section.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Particle Canvas */
        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* Glass Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 3rem;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: transform 0.1s ease-out;
        }

        .grid-item {
            border-left: 2px solid var(--primary);
            padding-left: 1.5rem;
            margin-bottom: 2rem;
        }

        /* AI Chat Styles */
        #chat-container {
            height: 300px;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 16px;
            border: 1px solid rgba(0, 242, 254, 0.2);
            overflow: hidden;
        }

        #chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) transparent;
        }

        .message {
            margin-bottom: 1rem;
            max-width: 85%;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .user-message {
            align-self: flex-end;
            background: var(--primary);
            color: var(--bg-dark);
            margin-left: auto;
            border-bottom-right-radius: 2px;
        }

        .ai-message {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-bottom-left-radius: 2px;
        }

        /* Credits Styles */
        .credits-container {
            height: 300px;
            overflow: hidden;
            position: relative;
            mask-image: linear-gradient(to bottom, transparent, black 15%, black 85%, transparent);
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            padding: 20px;
        }

        .credits-content {
            position: absolute;
            width: 100%;
            left: 0;
            animation: scroll-credits 20s linear infinite;
        }

        @keyframes scroll-credits {
            0% { transform: translateY(300px); }
            100% { transform: translateY(-120%); }
        }

        .btn-glow {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 242, 254, 0.3);
        }

        #transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-dark);
            z-index: 2000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .visualizer-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            height: 32px;
            width: 80px;
        }

        .beat-bar {
            width: 3px;
            height: 4px;
            background: var(--primary);
            border-radius: 2px;
            opacity: 0.3;
            transition: height 0.05s ease-out, opacity 0.1s;
        }

        .beat-bar.active {
            opacity: 1;
            box-shadow: 0 0 8px var(--primary);
        }

        .beat-title {
            transition: transform 0.1s ease-out;
        }

        #track-info {
            font-size: 9px;
            color: var(--primary);
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-right: 10px;
            white-space: nowrap;
        }
    </style>
</head>
<body>

    <div id="transition-overlay"></div>
    <canvas id="particle-canvas"></canvas>

    <div id="progress-container">
        <div id="page-title">MAIN PAGE</div>
        <div id="gauge-bar-bg">
            <div id="gauge-bar-fill"></div>
        </div>
    </div>

    <div id="audio-controls">
        <div id="track-info">AC/DC - Back in Black (Staccato Master)</div>
        <div class="visualizer-container" id="visualizer">
            <div class="beat-bar" id="bar-0"></div>
            <div class="beat-bar" id="bar-1"></div>
            <div class="beat-bar" id="bar-2"></div>
            <div class="beat-bar" id="bar-3"></div>
            <div class="beat-bar" id="bar-4"></div>
            <div class="beat-bar" id="bar-5"></div>
            <div class="beat-bar" id="bar-6"></div>
            <div class="beat-bar" id="bar-7"></div>
        </div>
        <button id="audio-toggle" class="w-10 h-10 flex items-center justify-center bg-cyan-500 rounded-full hover:scale-110 transition-transform shadow-lg shadow-cyan-500/50">
            <svg id="play-icon" class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            <svg id="pause-icon" class="w-5 h-5 text-white hidden" fill="currentColor" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
        </button>
    </div>

    <!-- 1. 메인 페이지 -->
    <section id="section-1" class="active">
        <div class="glass-card text-center main-card">
            <h2 class="text-blue-400 font-bold tracking-widest mb-2 uppercase opacity-80">2026 Korea RoboCup Open</h2>
            <h1 id="main-title" class="beat-title text-5xl md:text-8xl font-bold mb-10 bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-blue-500 tracking-tight">
                K.F.C. Codechaser
            </h1>
            
            <div class="flex justify-center gap-6 text-xl text-slate-300 font-light mb-16">
                <span>배지훈</span>
                <span class="text-slate-700">/</span>
                <span>장원우</span>
                <span class="text-slate-700">/</span>
                <span>김지온</span>
            </div>
            
            <button onclick="handleButtonClick(2)" class="group relative px-12 py-4 rounded-full overflow-hidden transition-all border border-cyan-500/30">
                <div class="absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-blue-500/10 group-hover:from-cyan-500/30 group-hover:to-blue-500/30 transition-all"></div>
                <span class="relative text-cyan-400 font-bold tracking-widest uppercase text-sm">Review Entry</span>
            </button>
        </div>
    </section>

    <!-- 2. 상세 페이지 (사용자 요청에 따라 내용 수정) -->
    <section id="section-2">
        <div class="glass-card">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 border-b border-white/10 pb-6">
                <h2 class="text-3xl font-bold flex items-center">
                    <span class="w-8 h-8 bg-cyan-500 rounded-lg mr-3 inline-flex items-center justify-center text-white text-sm font-bold">02</span>
                    대회 리얼 후기
                </h2>
                <div class="mt-4 md:mt-0 text-right">
                    <span class="text-cyan-400 text-xs font-bold tracking-widest uppercase block">Competition Review</span>
                    <span class="text-white text-xl font-light italic">Lessons, Regrets, and Strengths</span>
                </div>
            </div>
            <div class="grid md:grid-cols-2 gap-10">
                <div class="space-y-8">
                    <!-- 느낀 점 -->
                    <div class="grid-item">
                        <h3 class="text-cyan-400 font-bold mb-3 flex items-center uppercase text-sm tracking-widest">
                            느낀 점: "매 순간 최선을 다하자"
                        </h3>
                        <p class="text-slate-300 leading-relaxed text-sm">
                            이번 대회를 통해 기술적인 실력보다 더 중요한 것은 마음가짐이라는 것을 배웠습니다. 
                            예상치 못한 변수가 발생하더라도 끝까지 포기하지 않고 '매 순간 최선을 다하자'는 생각으로 임했습니다. 
                            준비 과정부터 실전까지 쏟아부은 열정이 우리 팀을 성장시킨 가장 큰 원동력이었습니다.
                        </p>
                    </div>
                    <!-- 아쉬운 점 -->
                    <div class="grid-item">
                        <h3 class="text-accent font-bold mb-3 flex items-center uppercase text-sm tracking-widest" style="color: #ff4d4d;">
                            아쉬운 점: "초음파 센서 값의 불안정성"
                        </h3>
                        <p class="text-slate-300 leading-relaxed text-sm">
                            가장 아쉬웠던 부분은 초음파 센서 값이 실전에서 불안정하게 튀었던 점입니다. 
                            연습 때는 잘 작동하던 센서가 대회장 환경에 따라 오차를 보였을 때 즉각적으로 대응하기 어려웠습니다. 
                            센서 필터링 알고리즘을 더 견고하게 짜지 못한 것이 이번 대회의 가장 큰 보완점으로 남았습니다.
                        </p>
                    </div>
                </div>
                <div class="space-y-8">
                    <!-- 잘한 점 -->
                    <div class="grid-item">
                        <h3 class="text-cyan-400 font-bold mb-3 flex items-center uppercase text-sm tracking-widest">
                            잘한 점: "빛났던 팀원과의 소통"
                        </h3>
                        <p class="text-slate-300 leading-relaxed text-sm">
                            우리 팀이 가장 잘한 것은 팀원 간의 유기적인 소통입니다. 
                            문제가 생겼을 때 서로 탓하지 않고, 각자의 위치에서 대안을 제시하며 활발하게 의견을 나눴습니다. 
                            지훈, 원우, 지온 세 명의 호흡이 완벽했기에 어려운 상황도 웃으며 헤쳐나갈 수 있었습니다.
                        </p>
                    </div>
                    <!-- 결론/다음 목표 -->
                    <div class="grid-item">
                        <h3 class="text-cyan-400 font-bold mb-3 flex items-center uppercase text-sm tracking-widest">
                            Our Next Step
                        </h3>
                        <p class="text-slate-300 leading-relaxed text-sm">
                            아쉬웠던 센서 문제를 해결하고, 강점인 팀워크를 더욱 강화하여 다음 대회에서는 완벽한 주행을 선보이겠습니다. 
                            최선을 다했던 이번의 기억이 우리 팀의 새로운 시작점이 될 것입니다.
                        </p>
                    </div>
                </div>
            </div>
            <div class="text-center mt-12 pt-6 border-t border-white/5">
                <button onclick="handleButtonClick(3)" class="text-slate-500 hover:text-white transition-colors underline underline-offset-8 uppercase tracking-widest text-[10px] font-bold">Go to Final Credits</button>
            </div>
        </div>
    </section>

    <!-- 3. 마무리 페이지 (Credits + AI) -->
    <section id="section-3">
        <div class="glass-card">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold tracking-tighter text-white">FINAL CREDITS</h2>
                <div class="w-12 h-1 bg-cyan-500 mx-auto mt-2"></div>
            </div>

            <div class="grid md:grid-cols-2 gap-8 items-start">
                <!-- Credits Scroll Area -->
                <div class="credits-container">
                    <div class="credits-content text-center space-y-12">
                        <div class="space-y-2">
                            <h4 class="text-cyan-400 text-xs font-bold uppercase tracking-widest">Main Developer</h4>
                            <p class="text-2xl text-white font-bold">배지훈 (Ji-hoon Bae)</p>
                        </div>
                        <div class="space-y-2">
                            <h4 class="text-cyan-400 text-xs font-bold uppercase tracking-widest">Hardware Lead</h4>
                            <p class="text-2xl text-white font-bold">장원우 (Won-woo Jang)</p>
                        </div>
                        <div class="space-y-2">
                            <h4 class="text-cyan-400 text-xs font-bold uppercase tracking-widest">Strategy Specialist</h4>
                            <p class="text-2xl text-white font-bold">김지온 (Ji-on Kim)</p>
                        </div>
                        <div class="pt-8 space-y-4">
                            <p class="text-slate-500 text-xs italic">2026 Korea RoboCup Open - Pyeongchang</p>
                            <div class="text-cyan-500/50 text-2xl font-bold pt-6 uppercase">K.F.C. Codechaser</div>
                        </div>
                    </div>
                </div>

                <!-- AI Concierge Area -->
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <h3 class="text-cyan-400 font-bold text-xs tracking-widest uppercase flex items-center">
                            <span class="w-2 h-2 bg-cyan-500 rounded-full mr-2 animate-pulse"></span>
                            Team KFC AI Concierge
                        </h3>
                        <span class="text-[10px] text-slate-500 font-mono">STATUS: ONLINE</span>
                    </div>
                    <div id="chat-container">
                        <div id="chat-messages" class="flex flex-col">
                            <div class="message ai-message">모든 크레딧을 확인하셨군요! 저는 K.F.C. Codechaser의 AI 비서입니다. 대회 뒷이야기나 기술적인 질문이 있으신가요? "Back in Black"의 록 스피릿으로 답변해 드릴게요!</div>
                        </div>
                        <div class="p-2 border-t border-white/10 flex gap-2 bg-black/40">
                            <input type="text" id="chat-input" placeholder="메시지를 입력하세요..." class="flex-1 bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-cyan-500 transition-colors text-white">
                            <button id="send-btn" class="bg-cyan-500 text-bg-dark px-4 py-2 rounded-lg text-sm font-bold hover:bg-cyan-400 transition-colors">전송</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-center mt-12 gap-6">
                <button onclick="handleButtonClick(1)" class="px-8 py-3 rounded-xl border border-white/10 text-slate-400 font-bold uppercase tracking-widest text-[10px] transition-all hover:border-white/30 hover:text-white">
                    Return to Start
                </button>
                <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="btn-glow px-10 py-3 rounded-xl text-white font-bold uppercase tracking-widest text-[10px] transition-transform hover:scale-105">
                    Top of Document
                </button>
            </div>
        </div>
    </section>

    <script>
        const apiKey = ""; 

        // -------------------------------------------------------------------------
        // IMPROVED AUDIO ENGINE - STACCATO & RIFF PRECISION
        // -------------------------------------------------------------------------
        let audioCtx;
        let isPlaying = false;
        let tempo = 92; 
        let nextNoteTime = 0.0;
        let currentStep = 0;
        let timerID;
        let distortionNode;

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                distortionNode = audioCtx.createWaveShaper();
                distortionNode.curve = makeDistortionCurve(600); 
                distortionNode.oversample = '4x';
                const masterGain = audioCtx.createGain();
                masterGain.gain.value = 0.75;
                distortionNode.connect(masterGain);
                masterGain.connect(audioCtx.destination);
            }
        }

        function makeDistortionCurve(amount) {
            const k = typeof amount === 'number' ? amount : 50;
            const n_samples = 44100;
            const curve = new Float32Array(n_samples);
            const deg = Math.PI / 180;
            for (let i = 0 ; i < n_samples; ++i ) {
                const x = i * 2 / n_samples - 1;
                curve[i] = ( 3 + k ) * x * 20 * deg / ( Math.PI + k * Math.abs(x) );
            }
            return curve;
        }

        const chords = {
            E: [82.41, 123.47, 164.81],
            D: [146.83, 220, 293.66],
            A: [110, 164.81, 220],
            G: [196, 392]
        };

        function playGuitar(freqs, time, duration, volume = 0.15) {
            const attackTime = 0.005;
            const holdTime = duration * 0.4; 

            freqs.forEach((freq, idx) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = (idx === 0) ? 'sawtooth' : 'triangle';
                osc.frequency.setValueAtTime(freq, time);
                
                gain.gain.setValueAtTime(0, time);
                gain.gain.linearRampToValueAtTime(volume, time + attackTime);
                gain.gain.setValueAtTime(volume, time + holdTime);
                gain.gain.linearRampToValueAtTime(0.001, time + duration * 0.9);

                osc.connect(gain);
                gain.connect(distortionNode);
                osc.start(time);
                osc.stop(time + duration);
            });
            setTimeout(() => visualizeBeat(volume * 8), (time - audioCtx.currentTime) * 1000);
        }

        function playDrums(time, type) {
            if (type === 'kick') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.frequency.setValueAtTime(160, time);
                osc.frequency.exponentialRampToValueAtTime(0.01, time + 0.3);
                gain.gain.setValueAtTime(1.2, time);
                gain.gain.exponentialRampToValueAtTime(0.01, time + 0.3);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(time); osc.stop(time + 0.3);
            } else if (type === 'snare') {
                const noise = audioCtx.createBufferSource();
                const bufSize = audioCtx.sampleRate * 0.12;
                const buf = audioCtx.createBuffer(1, bufSize, audioCtx.sampleRate);
                const data = buf.getChannelData(0);
                for(let i=0; i<bufSize; i++) data[i] = Math.random() * 2 - 1;
                noise.buffer = buf;
                const gain = audioCtx.createGain();
                gain.gain.setValueAtTime(0.5, time);
                gain.gain.exponentialRampToValueAtTime(0.01, time + 0.12);
                noise.connect(gain); gain.connect(audioCtx.destination);
                noise.start(time); noise.stop(time + 0.12);
            } else if (type === 'hihat') {
                const noise = audioCtx.createBufferSource();
                const bufSize = audioCtx.sampleRate * 0.04;
                const buf = audioCtx.createBuffer(1, bufSize, audioCtx.sampleRate);
                const data = buf.getChannelData(0);
                for(let i=0; i<bufSize; i++) data[i] = Math.random() * 2 - 1;
                noise.buffer = buf;
                const filter = audioCtx.createBiquadFilter();
                filter.type = 'highpass'; filter.frequency.value = 9000;
                const gain = audioCtx.createGain();
                gain.gain.setValueAtTime(0.12, time);
                gain.gain.exponentialRampToValueAtTime(0.01, time + 0.04);
                noise.connect(filter); filter.connect(gain); gain.connect(audioCtx.destination);
                noise.start(time); noise.stop(time + 0.04);
            }
        }

        function scheduleRiff(step, time) {
            playDrums(time, 'hihat');
            if (step % 4 === 0) playDrums(time, 'kick');
            if (step % 4 === 2) playDrums(time, 'snare');

            if (step === 0) playGuitar(chords.E, time, 0.4, 0.3); 
            if (step === 4) playGuitar(chords.D, time, 0.1, 0.25);
            if (step === 4.5) playGuitar(chords.D, time, 0.1, 0.25);
            if (step === 5) playGuitar(chords.D, time, 0.1, 0.25);
            if (step === 6) playGuitar(chords.A, time, 0.1, 0.25);
            if (step === 6.5) playGuitar(chords.A, time, 0.1, 0.25);
            if (step === 7) playGuitar(chords.A, time, 0.1, 0.25);
            if (step === 11) playGuitar([392], time, 0.06, 0.2);     
            if (step === 11.5) playGuitar([329.63], time, 0.06, 0.2); 
            if (step === 12) playGuitar([293.66], time, 0.06, 0.2);   
            if (step === 12.5) playGuitar([246.94], time, 0.06, 0.2); 
            if (step === 13) playGuitar([196], time, 0.06, 0.2);      
            if (step === 13.5) playGuitar([164.81], time, 0.06, 0.2); 
        }

        function scheduler() {
            while (nextNoteTime < audioCtx.currentTime + 0.1) {
                scheduleRiff(currentStep, nextNoteTime);
                nextNoteTime += 0.25 * (60.0 / tempo); 
                currentStep = (currentStep + 0.5) % 16;
            }
            timerID = window.setTimeout(scheduler, 25);
        }

        function visualizeBeat(intensity) {
            const title = document.getElementById('main-title');
            if (title) title.style.transform = `scale(${1 + intensity * 0.15})`;
            document.querySelectorAll('.beat-bar').forEach((bar) => {
                const h = intensity > 0 ? (4 + Math.random() * 50 * intensity) : 4;
                bar.style.height = `${h}px`;
                bar.classList.toggle('active', intensity > 0.1);
            });
        }

        document.getElementById('audio-toggle').addEventListener('click', function() {
            initAudio();
            if (isPlaying) {
                isPlaying = false;
                this.classList.replace('bg-red-500', 'bg-cyan-500');
                document.getElementById('play-icon').classList.remove('hidden');
                document.getElementById('pause-icon').classList.add('hidden');
                window.clearTimeout(timerID);
                visualizeBeat(0);
            } else {
                isPlaying = true;
                this.classList.replace('bg-cyan-500', 'bg-red-500');
                document.getElementById('play-icon').classList.add('hidden');
                document.getElementById('pause-icon').classList.remove('hidden');
                if (audioCtx.state === 'suspended') audioCtx.resume();
                nextNoteTime = audioCtx.currentTime;
                currentStep = 0;
                scheduler();
            }
        });

        // -------------------------------------------------------------------------
        // NAVIGATION & CHAT
        // -------------------------------------------------------------------------
        function handleButtonClick(idx) { scrollToSection(idx); }
        function scrollToSection(idx) {
            const ov = document.getElementById('transition-overlay');
            ov.style.opacity = '1';
            setTimeout(() => {
                document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
                const t = document.getElementById(`section-${idx}`);
                if (t) {
                    t.classList.add('active');
                    window.scrollTo({ top: t.offsetTop, behavior: 'auto' });
                    document.getElementById('gauge-bar-fill').style.width = (idx/3)*100+'%';
                    document.getElementById('page-title').innerText = idx === 1 ? 'MAIN PAGE' : idx === 2 ? 'RETROSPECTIVE' : 'CREDITS & AI';
                }
                ov.style.opacity = '0';
            }, 500);
        }

        const chatInput = document.getElementById('chat-input');
        const sendBtn = document.getElementById('send-btn');
        const chatMessages = document.getElementById('chat-messages');

        async function callGemini(query) {
            const systemPrompt = `당신은 2026 로보컵 오픈에 참여한 'K.F.C. Codechaser' 팀의 AI 비서입니다. 
            팀원: 배지훈(메인 개발), 장원우(하드웨어), 김지온(전략). 
            말투는 친절하고 전문적이며 AC/DC의 록 스피릿(Rock Spirit)이 느껴지게 하세요.`;
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: query }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });
                if (!response.ok) throw new Error('API request failed');
                const result = await response.json();
                return result.candidates?.[0]?.content?.parts?.[0]?.text || "답변을 가져오지 못했습니다.";
            } catch (error) {
                return "Rock 'n' Roll! (통신 오류 발생)";
            }
        }

        async function handleSendMessage() {
            const text = chatInput.value.trim();
            if (!text) return;
            const userDiv = document.createElement('div');
            userDiv.className = 'message user-message';
            userDiv.innerText = text;
            chatMessages.appendChild(userDiv);
            chatInput.value = '';
            chatMessages.scrollTop = chatMessages.scrollHeight;
            const aiDiv = document.createElement('div');
            aiDiv.className = 'message ai-message';
            aiDiv.innerText = "...";
            chatMessages.appendChild(aiDiv);
            const response = await callGemini(text);
            aiDiv.innerText = response;
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        sendBtn.addEventListener('click', handleSendMessage);
        chatInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleSendMessage(); });

        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();
        class P {
            constructor() { this.x = Math.random()*canvas.width; this.y = Math.random()*canvas.height; this.v = (Math.random()-0.5)*0.5; this.size = Math.random() * 2; }
            up() { this.x += this.v; this.y += this.v; if(this.x<0||this.x>canvas.width)this.v*=-1; }
            dr() { ctx.beginPath(); ctx.arc(this.x,this.y,this.size,0,Math.PI*2); ctx.fillStyle='rgba(0,242,254,0.3)'; ctx.fill(); }
        }
        for(let i=0;i<60;i++) particles.push(new P());
        function anim() { ctx.clearRect(0,0,canvas.width,canvas.height); particles.forEach(p=>{p.up();p.dr();}); requestAnimationFrame(anim); }
        anim();
    </script>
</body>
</html>
