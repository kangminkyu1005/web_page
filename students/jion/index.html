<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.F.C.codechase - 2026 한국 로봇컵 오픈</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+KR:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #050505;
            --accent-yellow: #fcee0a;
            --accent-blue: #00f0ff;
            --accent-pink: #ff003c;
            --text-color: #e0e0e0;
            --panel-bg: rgba(10, 10, 10, 0.95);
            --transition-speed: 0.8s;
            --header-height: 80px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: none !important; 
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        *::-webkit-scrollbar { display: none; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Noto Sans KR', sans-serif;
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            perspective: 1200px;
            transition: transform 0.05s ease-out, background-color 0.1s ease;
        }

        body.flash { background-color: #fff !important; }

        #starfield { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        #effect-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 999999; pointer-events: none; }

        #progress-container {
            position: fixed;
            top: 0; left: 0; width: 100%;
            padding: 20px 10%;
            z-index: 100;
            background: linear-gradient(to bottom, var(--bg-color), transparent);
        }

        #page-title {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-blue);
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-bottom: 8px;
            font-size: 0.75rem;
            text-shadow: 0 0 10px var(--accent-blue);
        }

        .gauge-bar { width: 100%; height: 2px; background: rgba(0, 240, 255, 0.1); position: relative; }
        #gauge-fill {
            height: 100%;
            background: var(--accent-blue);
            width: 33.33%;
            transition: width var(--transition-speed) cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: 0 0 15px var(--accent-blue);
        }

        .page {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: var(--header-height) 2rem 2rem 2rem;
            opacity: 0; visibility: hidden;
            transform: translateZ(-100px);
            transition: all var(--transition-speed) cubic-bezier(0.19, 1, 0.22, 1);
        }

        .page.active { opacity: 1; visibility: visible; transform: translateZ(0); }

        .cyber-panel {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 240, 255, 0.2);
            border-left: 4px solid var(--accent-yellow);
            padding: 40px;
            max-width: 850px; width: 100%;
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            clip-path: polygon(0 0, 97% 0, 100% 3%, 100% 100%, 3% 100%, 0 97%);
        }

        .tag { font-family: 'Orbitron', sans-serif; color: var(--accent-pink); font-size: 0.75rem; letter-spacing: 3px; margin-bottom: 10px; display: block; }
        h1 { font-family: 'Orbitron', sans-serif; font-size: clamp(2rem, 6vw, 3.5rem); color: var(--accent-yellow); margin-bottom: 25px; line-height: 1; text-transform: uppercase; }
        .description { font-size: 1.1rem; line-height: 1.7; margin-bottom: 30px; color: #bbb; border-left: 2px solid var(--accent-blue); padding-left: 20px; }

        .data-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .data-box { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.05); padding: 15px; position: relative; overflow: hidden; }
        .data-box::before { content: ""; position: absolute; top: 0; left: 0; width: 2px; height: 100%; background: var(--accent-blue); opacity: 0.5; }
        .data-label { font-family: 'Orbitron', sans-serif; font-size: 0.65rem; color: var(--accent-blue); margin-bottom: 8px; display: block; opacity: 0.8; }
        .data-value { font-size: 0.95rem; font-weight: 500; line-height: 1.5; }

        /* Interaction Elements (Page 3) */
        .interaction-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
        }

        .guestbook-log {
            height: 180px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 240, 255, 0.1);
            padding: 15px;
            font-size: 0.9rem;
            color: #888;
        }

        .guest-entry {
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.05);
            display: flex;
            gap: 10px;
        }

        .guest-entry .time { color: var(--accent-pink); font-family: 'Orbitron'; font-size: 0.7rem; }
        .guest-entry .text { color: var(--text-color); }

        .input-row {
            display: flex;
            gap: 10px;
        }

        .cyber-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--accent-blue);
            padding: 12px;
            color: white;
            font-family: 'Noto Sans KR';
            outline: none;
        }

        .replay-status {
            font-family: 'Orbitron';
            font-size: 0.7rem;
            color: var(--accent-yellow);
            display: none;
            margin-top: 10px;
        }

        .cyber-btn {
            background: transparent; border: 1px solid var(--accent-blue); color: var(--accent-blue);
            padding: 12px 30px; font-family: 'Orbitron', sans-serif; font-weight: bold; text-transform: uppercase;
            letter-spacing: 2px; transition: 0.3s;
            position: relative; overflow: hidden;
        }
        .cyber-btn:hover { background: var(--accent-blue); color: var(--bg-color); box-shadow: 0 0 20px var(--accent-blue); }
        .cyber-btn.active { border-color: var(--accent-pink); color: var(--accent-pink); }

        #audio-init-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 1000000;
            display: flex; justify(content): center; align-items: center;
            color: var(--accent-blue); font-family: 'Orbitron'; cursor: pointer; text-align: center;
        }

        body::after {
            content: " "; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.15) 50%);
            background-size: 100% 3px; z-index: 1000; pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="audio-init-overlay" onclick="initAudio()">
        <div>
            <p style="font-size: 2rem; margin-bottom: 10px;">K.F.C.codechase</p>
            <p style="letter-spacing: 5px;">[ CLICK TO SYNC NEURAL AUDIO ]</p>
        </div>
    </div>

    <canvas id="starfield"></canvas>
    <canvas id="effect-canvas"></canvas>

    <div id="progress-container">
        <div id="page-title">RETROSPECTIVE_CORE_INITIALIZED</div>
        <div class="gauge-bar"><div id="gauge-fill"></div></div>
    </div>

    <!-- Page 1: Overview -->
    <section id="page-1" class="page active">
        <div class="cyber-panel">
            <span class="tag">2026 KOREA ROBOCUP OPEN</span>
            <h1>K.F.C.<br>CODECHASE</h1>
            <p class="description">로봇 공학의 한계를 시험하고, 팀워크와 기술의 융합을 통해 자율주행 로봇 시스템의 새로운 가능성을 탐구한 프로젝트 리트로스펙티브입니다.</p>
            <div class="data-grid">
                <div class="data-box" style="grid-column: span 2;"><span class="data-label">OPERATIVES</span><span class="data-value">김지온, 이서진, 장원우, 배지훈</span></div>
            </div>
            <button class="cyber-btn" onclick="navigateTo(2)">View Detail Report</button>
        </div>
    </section>

    <!-- Page 2: Details -->
    <section id="page-2" class="page">
        <div class="cyber-panel" style="border-left-color: var(--accent-pink);">
            <span class="tag">02_DETAILED_RETROSPECTIVE</span>
            <h1>상세 페이지</h1>
            <div class="data-grid">
                <div class="data-box">
                    <span class="data-label">01. MOST REGRETTABLE</span>
                    <span class="data-value">팀원과 소통이 생각보다 잘 안된 것</span>
                </div>
                <div class="data-box">
                    <span class="data-label">02. AREA FOR IMPROVEMENT</span>
                    <span class="data-value">팀원과 소통을 더 잘하는 것</span>
                </div>
                <div class="data-box">
                    <span class="data-label">03. TEAM STRENGTH</span>
                    <span class="data-value">프로그래밍 하는 것</span>
                </div>
                <div class="data-box" style="grid-column: span 2; border-left-color: var(--accent-pink);">
                    <span class="data-label" style="color: var(--accent-pink);">04. CORE LESSON</span>
                    <span class="data-value">월드 1, 2의 팀원끼리 소통이 잘 안되면 아무리 프로그래밍이 좋아도 점수가 프로그램을 따라오지 못 한다.</span>
                </div>
            </div>
            <button class="cyber-btn" onclick="navigateTo(3)">Go to Interaction</button>
        </div>
    </section>

    <!-- Page 3: Guestbook & Replay -->
    <section id="page-3" class="page">
        <div class="cyber-panel" style="border-left-color: var(--accent-blue);">
            <span class="tag">03_INTERACTION_ZONE</span>
            <h1>방명록 & 리플레이</h1>
            
            <div class="interaction-container">
                <div class="guestbook-log" id="guestbook-log">
                    <div class="guest-entry"><span class="time">CORE_SYSTEM</span><span class="text">Interaction Hub 초기화 완료. 메시지를 남겨주세요.</span></div>
                </div>
                
                <div class="input-row">
                    <input type="text" id="guest-input" class="cyber-input" placeholder="커넥션 메시지 입력...">
                    <button class="cyber-btn" onclick="saveMessage()">SEND</button>
                </div>

                <div style="display: flex; gap: 15px; margin-top: 10px;">
                    <button class="cyber-btn" id="replay-btn" onclick="triggerReplay()">REPLAY START</button>
                    <button class="cyber-btn" onclick="navigateTo(1)">Back to Start</button>
                </div>
                <div id="replay-indicator" class="replay-status">REPLAYING_DATA_SEQUENCE... [0%]</div>
            </div>
        </div>
    </section>

    <script>
        const starCanvas = document.getElementById('starfield');
        const starCtx = starCanvas.getContext('2d');
        const effectCanvas = document.getElementById('effect-canvas');
        const effectCtx = effectCanvas.getContext('2d');
        
        let stars = [];
        let slashes = []; 
        let mouseX = window.innerWidth / 2;
        let mouseY = window.innerHeight / 2;
        
        // Combo State 조정
        let clickCount = 0;
        let comboStartTime = null;
        const COMBO_LIMIT = 10;
        const TIME_LIMIT = 5000; // 5초 제한 (5000ms)

        // Audio System
        let audioCtx = null;
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                document.getElementById('audio-init-overlay').style.display = 'none';
                const source = audioCtx.createBufferSource();
                source.buffer = audioCtx.createBuffer(1, 1, 22050);
                source.connect(audioCtx.destination);
                source.start(0);
            }
        }

        function playBladeSound(isHyper = false) {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = isHyper ? 'sawtooth' : 'triangle';
            osc.frequency.setValueAtTime(isHyper ? 1500 : 800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(isHyper ? 50 : 100, audioCtx.currentTime + (isHyper ? 0.2 : 0.1));
            gain.gain.setValueAtTime(isHyper ? 0.25 : 0.08, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + (isHyper ? 0.3 : 0.15));
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + (isHyper ? 0.3 : 0.15));
        }

        // Guestbook Logic
        function saveMessage() {
            const input = document.getElementById('guest-input');
            const log = document.getElementById('guestbook-log');
            if (input.value.trim() === "") return;

            const time = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = 'guest-entry';
            entry.innerHTML = `<span class="time">${time}</span><span class="text">${input.value}</span>`;
            log.prepend(entry);
            
            playBladeSound(false);
            input.value = "";
            log.scrollTop = 0;
        }

        // Replay Logic
        function triggerReplay() {
            const indicator = document.getElementById('replay-indicator');
            indicator.style.display = 'block';
            
            let sequence = [
                { page: 1, delay: 0, progress: 33 },
                { page: 2, delay: 2000, progress: 66 },
                { page: 3, delay: 4000, progress: 100 }
            ];

            sequence.forEach((step, index) => {
                setTimeout(() => {
                    navigateTo(step.page);
                    indicator.innerText = `REPLAYING_DATA_SEQUENCE... [${step.progress}%]`;
                    playBladeSound(index === sequence.length - 1);
                    if(index === sequence.length - 1) {
                        setTimeout(() => {
                            indicator.innerText = "REPLAY_COMPLETE";
                            setTimeout(() => indicator.style.display = 'none', 2000);
                        }, 1000);
                    }
                }, step.delay);
            });
        }

        function init() {
            starCanvas.width = effectCanvas.width = window.innerWidth;
            starCanvas.height = effectCanvas.height = window.innerHeight;
            stars = [];
            for (let i = 0; i < 200; i++) {
                stars.push({ x: Math.random() * starCanvas.width, y: Math.random() * starCanvas.height, z: Math.random() * starCanvas.width, o: Math.random() });
            }
        }

        class SlashMark {
            constructor(x, y, isHyper = false) {
                this.x = isHyper ? Math.random() * window.innerWidth : x;
                this.y = isHyper ? Math.random() * window.innerHeight : y;
                this.isHyper = isHyper;
                this.angle = isHyper ? (Math.random() * Math.PI) : (Math.random() * Math.PI * 2);
                this.length = isHyper ? window.innerWidth * 1.5 : (60 + Math.random() * 120);
                this.width = isHyper ? (15 + Math.random() * 35) : (2 + Math.random() * 5);
                this.life = 1.0;
                this.decay = isHyper ? 0.025 : (0.04 + Math.random() * 0.06);
                this.color = isHyper ? "#fff" : (Math.random() > 0.5 ? "#ff003c" : "#00f0ff");
            }
            draw() {
                effectCtx.save();
                effectCtx.translate(this.x, this.y);
                effectCtx.rotate(this.angle);
                effectCtx.globalAlpha = this.life;
                effectCtx.shadowBlur = this.isHyper ? 60 : 15;
                effectCtx.shadowColor = this.isHyper ? (Math.random() > 0.5 ? "#00f0ff" : "#ff003c") : this.color;
                effectCtx.fillStyle = this.isHyper ? "#fff" : this.color;
                effectCtx.beginPath();
                effectCtx.moveTo(-this.length/2, 0);
                effectCtx.lineTo(this.length/2, -this.width/2);
                effectCtx.lineTo(this.length/2, this.width/2);
                effectCtx.closePath();
                effectCtx.fill();
                effectCtx.restore();
            }
            update() { this.life -= this.decay; }
        }

        function triggerHyperSlash() {
            const slashCount = 24; 
            const interval = 40; 
            shakeScreen(30, 1000);
            for (let i = 0; i < slashCount; i++) {
                setTimeout(() => {
                    playBladeSound(true);
                    slashes.push(new SlashMark(0, 0, true));
                    if (i % 6 === 0) {
                        document.body.classList.add('flash');
                        setTimeout(() => document.body.classList.remove('flash'), 40);
                    }
                }, i * interval);
            }
        }

        function resetCombo() {
            clickCount = 0;
            comboStartTime = null;
        }

        function shakeScreen(intensity, duration) {
            const start = Date.now();
            const timer = setInterval(() => {
                const elapsed = Date.now() - start;
                if (elapsed > duration) {
                    document.body.style.transform = 'translate(0,0)';
                    clearInterval(timer);
                    return;
                }
                document.body.style.transform = `translate(${(Math.random()-0.5)*intensity}px, ${(Math.random()-0.5)*intensity}px)`;
            }, 16);
        }

        function draw() {
            starCtx.fillStyle = '#050505';
            starCtx.fillRect(0, 0, starCanvas.width, starCanvas.height);
            stars.forEach(star => {
                const k = 128 / star.z;
                const px = (star.x - starCanvas.width / 2) * k + starCanvas.width / 2;
                const py = (star.y - starCanvas.height / 2) * k + starCanvas.height / 2;
                if (px >= 0 && px <= starCanvas.width && py >= 0 && py <= starCanvas.height) {
                    starCtx.fillStyle = star.z < starCanvas.width / 2 ? '#00f0ff' : '#ffffff';
                    starCtx.globalAlpha = star.o;
                    starCtx.beginPath();
                    starCtx.arc(px, py, (1 - star.z / starCanvas.width) * 3, 0, Math.PI * 2);
                    starCtx.fill();
                }
                star.z -= 1.2;
                if (star.z <= 0) star.z = starCanvas.width;
            });

            effectCtx.clearRect(0, 0, effectCanvas.width, effectCanvas.height);
            effectCtx.globalCompositeOperation = 'lighter';
            for (let i = slashes.length - 1; i >= 0; i--) {
                slashes[i].update();
                slashes[i].draw();
                if (slashes[i].life <= 0) slashes.splice(i, 1);
            }

            effectCtx.globalCompositeOperation = 'source-over';
            effectCtx.strokeStyle = "#00f0ff";
            effectCtx.lineWidth = 1.2;
            effectCtx.beginPath();
            effectCtx.moveTo(mouseX - 20, mouseY); effectCtx.lineTo(mouseX + 20, mouseY);
            effectCtx.moveTo(mouseX, mouseY - 20); effectCtx.lineTo(mouseX, mouseY + 20);
            effectCtx.stroke();
            effectCtx.strokeRect(mouseX - 5, mouseY - 5, 10, 10);

            requestAnimationFrame(draw);
        }

        window.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; });
        window.addEventListener('mousedown', e => {
            if (!audioCtx) return;
            const now = Date.now();
            
            // 콤보 체크 로직 업데이트
            if (clickCount === 0 || (now - comboStartTime > TIME_LIMIT)) {
                // 첫 클릭이거나 5초가 지났으면 새로 시작
                comboStartTime = now;
                clickCount = 1;
            } else {
                clickCount++;
            }

            playBladeSound(false);
            for(let i=0; i<3; i++) slashes.push(new SlashMark(e.clientX, e.clientY));
            
            // 5초 내에 10회 달성 시 하이퍼 슬래시 발동
            if (clickCount >= COMBO_LIMIT) {
                triggerHyperSlash();
                resetCombo();
            }
        });

        function navigateTo(pageNum) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${pageNum}`).classList.add('active');
            
            const totalPages = 3;
            document.getElementById('gauge-fill').style.width = (pageNum / totalPages * 100) + '%';
        }

        window.addEventListener('resize', init);
        window.onload = () => { init(); draw(); };
    </script>
</body>
</html>
